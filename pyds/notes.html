<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-08 Mon 22:16 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python Data Science Handbook Notes</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://thomasf.github.io/solarized-css/solarized-dark.min.css" />
<style>pre.example {background: #001e26;} table{margin: 0 auto;}</style>

<script type="text/javascript" src="http://thomasf.github.io/solarized-css/org-info.min.js">
/**
 *
 * @source: http://thomasf.github.io/solarized-css/org-info.min.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in http://thomasf.github.io/solarized-css/org-info.min.js.
 *
 * Copyright (C) 2012-2019 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in http://thomasf.github.io/solarized-css/org-info.min.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "3");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "0");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "1");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Python Data Science Handbook Notes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4676a37">1. IPython</a>
<ul>
<li><a href="#orgf504654">1.1. Shell commands</a></li>
<li><a href="#orgcc7fb21">1.2. Debugger</a></li>
<li><a href="#org43b037d">1.3. Timing</a></li>
</ul>
</li>
<li><a href="#org8daa8f4">2. NumPy</a>
<ul>
<li><a href="#org0ec6e0a">2.1. Array creating functions</a></li>
<li><a href="#orge3a5db4">2.2. Array attributes</a></li>
<li><a href="#org4be0c61">2.3. Array slicing</a></li>
<li><a href="#org6e9b9ad">2.4. Change dimension</a></li>
<li><a href="#org029efa4">2.5. Merging and splitting</a></li>
<li><a href="#orgf32e0aa">2.6. Specify output container</a></li>
<li><a href="#orgb0b320a">2.7. reduce() and accumulate()</a></li>
<li><a href="#org4f28473">2.8. Sort and index sort</a></li>
<li><a href="#org979d869">2.9. Example: k-Nearest Neighbors</a></li>
</ul>
</li>
<li><a href="#org02ebea1">3. Pandas</a>
<ul>
<li><a href="#org0b1b2d8">3.1. Series</a>
<ul>
<li><a href="#org04631be">3.1.1. Constructing</a></li>
</ul>
</li>
<li><a href="#org9e56ad3">3.2. DataFrame</a>
<ul>
<li><a href="#org9aa2b43">3.2.1. Indexing DataFrames</a></li>
<li><a href="#org5303931">3.2.2. Operations</a></li>
</ul>
</li>
<li><a href="#orge2db4f7">3.3. Missing data</a></li>
<li><a href="#org4f033e0">3.4. Hierarchical Indexing</a></li>
<li><a href="#orge5ecfd9">3.5. Merge and join</a>
<ul>
<li><a href="#org4e8623c">3.5.1. Specifying Set Arithmetic for Joins</a></li>
</ul>
</li>
<li><a href="#org2f0ba9b">3.6. Aggregation and grouping</a>
<ul>
<li><a href="#org0aebcc3">3.6.1. GroupBy</a></li>
<li><a href="#orgab21ac4">3.6.2. Pivot tables</a></li>
</ul>
</li>
<li><a href="#org6a48936">3.7. <span class="todo TODO">TODO</span> Working with time (reread this)</a></li>
</ul>
</li>
<li><a href="#orgeb5f052">4. Matplotlib</a>
<ul>
<li><a href="#org0dd08a0">4.1. MATLAB-style interface</a></li>
<li><a href="#orge6a1d82">4.2. Object-oriented interface</a></li>
<li><a href="#org8ba08fb">4.3. Line plot</a></li>
<li><a href="#orge97b90e">4.4. Scatter plots</a></li>
<li><a href="#orgfb76efb">4.5. Visualizing errors</a></li>
<li><a href="#org79b2876">4.6. Visualizing three-dimensional function with <code>contour()</code> and <code>imshow()</code></a></li>
<li><a href="#org827cc76">4.7. Histograms, Binnings, and Density</a></li>
<li><a href="#org2c47a6c">4.8. Subplots arrangement</a></li>
<li><a href="#orgbf060d8">4.9. Arrows and annotation</a></li>
<li><a href="#org60fb2ab">4.10. 3D plots</a></li>
<li><a href="#orgdc03aed">4.11. <span class="todo TODO">TODO</span> Geographics data with Basemap</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4676a37" class="outline-2">
<h2 id="org4676a37"><span class="section-number-2">1</span> IPython</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgf504654" class="outline-3">
<h3 id="orgf504654"><span class="section-number-3">1.1</span> Shell commands</h3>
<div class="outline-text-3" id="text-1-1">
<p>
All shell commands can be used with <code>!</code> prefix.  Results can be assigned to
python variables.  <code>!</code> functions run in temporary shell.  <code>%</code> <b>magic</b>
functions has permanent effect. Many <code>%</code> magic functions can be used without
<code>%</code>, these are called <b>automagic</b> functions.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">files</span> = !ls
files
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">notes.html</td>
<td class="org-left">notes.org</td>
<td class="org-left">obipy</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgcc7fb21" class="outline-3">
<h3 id="orgcc7fb21"><span class="section-number-3">1.2</span> Debugger</h3>
<div class="outline-text-3" id="text-1-2">
<p>
<code>%debug</code> to enter debugger on last exception
</p>
</div>
</div>

<div id="outline-container-org43b037d" class="outline-3">
<h3 id="org43b037d"><span class="section-number-3">1.3</span> Timing</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li><code>%timeit</code> - one line, may run multiple times for short functions</li>
<li><code>%%timeit</code> - works for multiple code lines, may run multple times</li>
<li><code>%time</code> - only run one time</li>
<li><code>%%time</code> - only run one time, multi line cell</li>
<li><code>%prun</code> - profile function call</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org8daa8f4" class="outline-2">
<h2 id="org8daa8f4"><span class="section-number-2">2</span> NumPy</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org0ec6e0a" class="outline-3">
<h3 id="org0ec6e0a"><span class="section-number-3">2.1</span> Array creating functions</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li><code>np.zeros(10, dtype=int)</code></li>
<li><code>np.ones((3,5), dtype=float)</code></li>
<li><code>np.full((3,5), 3.14)</code></li>
<li><code>np.arange(0, 20, 2)</code></li>
<li><code>np.linspace(0, 1, 5)</code></li>
<li><code>np.random.random((3, 3))</code></li>
<li><code>np.random.normal(0, 1, (3, 3))</code> normally distributed random values</li>
<li><code>np.random.randint(0, 10, (3, 3))</code></li>
<li><code>np.eye(3)</code>  3x3 identity matrix</li>
<li><code>np.empty(3)</code> uninitialized array</li>
</ul>
</div>
</div>
<div id="outline-container-orge3a5db4" class="outline-3">
<h3 id="orge3a5db4"><span class="section-number-3">2.2</span> Array attributes</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x3</span> = np.random.randint(10, size=(3, 4, 5))
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 ndim"</span>, x3.ndim)         <span style="color: #586e75;"># </span><span style="color: #586e75;">dimension</span>
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 shape"</span>, x3.shape)       <span style="color: #586e75;"># </span><span style="color: #586e75;">shape</span>
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 size"</span>, x3.size)         <span style="color: #586e75;"># </span><span style="color: #586e75;">total elements</span>
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 dtype"</span>, x3.dtype)       <span style="color: #586e75;"># </span><span style="color: #586e75;">array type</span>
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 itemsize"</span>, x3.itemsize) <span style="color: #586e75;"># </span><span style="color: #586e75;">bytes per item</span>
<span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"x3 nbytes"</span>, x3.nbytes)     <span style="color: #586e75;"># </span><span style="color: #586e75;">total bytes</span>
</pre>
</div>

<pre class="example">
x3 ndim 3
x3 shape (3, 4, 5)
x3 size 60
x3 dtype int32
x3 itemsize 4
x3 nbytes 240

</pre>
</div>
</div>

<div id="outline-container-org4be0c61" class="outline-3">
<h3 id="org4be0c61"><span class="section-number-3">2.3</span> Array slicing</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Slicing returns a <b>view</b> into the original. No copy is made.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x2</span> = np.random.randint(10, size=(3, 4))
x2
</pre>
</div>

<pre class="example">
array([[7, 4, 4, 2],
       [5, 9, 2, 1],
       [6, 9, 2, 3]])

</pre>

<p>
Extract 2x2
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">x2[:2, :2]
</pre>
</div>

<pre class="example">
array([[7, 4],
       [5, 9]])

</pre>

<p>
Reverse
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">x2[::-1, ::-1]
</pre>
</div>

<pre class="example">
array([[3, 2, 9, 6],
       [1, 2, 9, 5],
       [2, 4, 4, 7]])

</pre>

<p>
Get column
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">x2[:, 0]
</pre>
</div>

<pre class="example">
array([7, 5, 6])

</pre>

<p>
Get row
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">x2[0, :]
</pre>
</div>

<pre class="example">
array([7, 4, 4, 2])

</pre>

<p>
To make a copy,  use .copy()
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python">x2[:2, :2].copy()
</pre>
</div>

<pre class="example">
array([[7, 4],
       [5, 9]])

</pre>
</div>
</div>

<div id="outline-container-org6e9b9ad" class="outline-3">
<h3 id="org6e9b9ad"><span class="section-number-3">2.4</span> Change dimension</h3>
<div class="outline-text-3" id="text-2-4">
<p>
With <code>.reshape()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.array([1,2,3])
x.reshape((1,3))  <span style="color: #586e75;"># </span><span style="color: #586e75;">make row vector</span>
</pre>
</div>

<pre class="example">
array([[1, 2, 3]])

</pre>

<div class="org-src-container">
<pre class="src src-jupyter-python">x.reshape((3,1))  <span style="color: #586e75;"># </span><span style="color: #586e75;">make column vector</span>
</pre>
</div>

<pre class="example">
array([[1],
       [2],
       [3]])

</pre>

<p>
Or with <code>np.newaxis</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">x[np.newaxis, :]
</pre>
</div>

<pre class="example">
array([[1, 2, 3]])

</pre>

<div class="org-src-container">
<pre class="src src-jupyter-python">x[:, np.newaxis]
</pre>
</div>

<pre class="example">
array([[1],
       [2],
       [3]])

</pre>
</div>
</div>

<div id="outline-container-org029efa4" class="outline-3">
<h3 id="org029efa4"><span class="section-number-3">2.5</span> Merging and splitting</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Merging with <code>np.concatenate()</code>, <code>np.vstack()</code>, <code>np.hstack()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">np.concatenate([x2, x2]) <span style="color: #586e75;"># </span><span style="color: #586e75;">or np.vstack()</span>
</pre>
</div>

<pre class="example">
array([[7, 4, 4, 2],
       [5, 9, 2, 1],
       [6, 9, 2, 3],
       [7, 4, 4, 2],
       [5, 9, 2, 1],
       [6, 9, 2, 3]])

</pre>

<div class="org-src-container">
<pre class="src src-jupyter-python">np.concatenate([x2, x2], axis=1) <span style="color: #586e75;"># </span><span style="color: #586e75;">or np.hstack()</span>
</pre>
</div>

<pre class="example">
array([[7, 4, 4, 2, 7, 4, 4, 2],
       [5, 9, 2, 1, 5, 9, 2, 1],
       [6, 9, 2, 3, 6, 9, 2, 3]])

</pre>

<p>
Split with <code>np.split()</code> , <code>np.hsplit()</code> , <code>np.vsplit()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = [1, 2, 3, 99, 99, 3, 2, 1]
np.split(x, [3, 5]) <span style="color: #586e75;"># </span><span style="color: #586e75;">pass a list of split points</span>
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">array</td>
<td class="org-left">((1 2 3))</td>
<td class="org-left">array</td>
<td class="org-left">((99 99))</td>
<td class="org-left">array</td>
<td class="org-left">((3 2 1))</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf32e0aa" class="outline-3">
<h3 id="orgf32e0aa"><span class="section-number-3">2.6</span> Specify output container</h3>
<div class="outline-text-3" id="text-2-6">
<p>
To avoid creating temporaries.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.arange(5)
<span style="color: #268bd2;">y</span> = np.empty(5)
np.multiply(x, 10, out=y)
y
</pre>
</div>

<pre class="example">
array([ 0., 10., 20., 30., 40.])

</pre>

<p>
This can even be used with array views. For example, we can write the results
of a computation to every other element of a specified array:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">y</span> = np.zeros(10)
np.power(2, x, out=y[::2])
y
</pre>
</div>

<pre class="example">
array([ 1.,  0.,  2.,  0.,  4.,  0.,  8.,  0., 16.,  0.])

</pre>
</div>
</div>

<div id="outline-container-orgb0b320a" class="outline-3">
<h3 id="orgb0b320a"><span class="section-number-3">2.7</span> reduce() and accumulate()</h3>
<div class="outline-text-3" id="text-2-7">
<p>
ufuncs supports <code>reduce()</code> and <code>accumulate()</code>
</p>

<p>
<code>reduce()</code> computes a final result.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.arange(1, 6)
np.add.<span style="color: #839496; font-weight: bold;">reduce</span>(x)
</pre>
</div>

<pre class="example">
15

</pre>

<p>
<code>accumulate()</code> saves all intermediate results.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">np.add.accumulate(x)
</pre>
</div>

<pre class="example">
array([ 1,  3,  6, 10, 15], dtype=int32)

</pre>
</div>
</div>

<div id="outline-container-org4f28473" class="outline-3">
<h3 id="org4f28473"><span class="section-number-3">2.8</span> Sort and index sort</h3>
<div class="outline-text-3" id="text-2-8">
<p>
<code>np.sort()</code> returns new copy of sorted array.
</p>

<p>
<code>x.sort()</code> sorts <code>x</code> in place.
</p>

<p>
<code>np.argsort()</code> returns sorted index array.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.array([2,1,4,3,5])
np.sort(x)
</pre>
</div>

<pre class="example">
array([1, 2, 3, 4, 5])

</pre>

<div class="org-src-container">
<pre class="src src-jupyter-python">np.argsort(x)
</pre>
</div>

<pre class="example">
array([1, 0, 3, 2, 4], dtype=int64)

</pre>
</div>
</div>

<div id="outline-container-org979d869" class="outline-3">
<h3 id="org979d869"><span class="section-number-3">2.9</span> Example: k-Nearest Neighbors</h3>
<div class="outline-text-3" id="text-2-9">
<p>
<a href="https://jakevdp.github.io/PythonDataScienceHandbook/02.08-sorting.html">https://jakevdp.github.io/PythonDataScienceHandbook/02.08-sorting.html</a>
</p>

<ul class="org-ul">
<li>Create 10 random points.</li>
<li>Compute the distance between each pair of points.</li>
<li>Take the 2 left most columns.</li>
</ul>

<div class="org-src-container">
<pre class="src src-jupyter-python">np.random.seed(42)
<span style="color: #268bd2;">X</span> = np.random.rand(10, 2)
<span style="color: #268bd2;">dist_sq</span> = np.<span style="color: #839496; font-weight: bold;">sum</span>((X[:, np.newaxis, :] - X[np.newaxis, :, :]) ** 2, axis=-1)
<span style="color: #268bd2;">K</span> = 2
<span style="color: #268bd2;">nearest_partition</span> = np.argpartition(dist_sq, K + 1, axis=1)
plt.scatter(X[:, 0], X[:, 1], s=100)
<span style="color: #859900; font-weight: bold;">for</span> i <span style="color: #859900; font-weight: bold;">in</span> <span style="color: #839496; font-weight: bold;">range</span>(X.shape[0]):
    <span style="color: #859900; font-weight: bold;">for</span> j <span style="color: #859900; font-weight: bold;">in</span> nearest_partition[i, :K+1]:
        <span style="color: #586e75;"># </span><span style="color: #586e75;">plot a line from X[i] to X[j]</span>
        <span style="color: #586e75;"># </span><span style="color: #586e75;">use some zip magic to make it happen:</span>
        plt.plot(*<span style="color: #839496; font-weight: bold;">zip</span>(X[j], X[i]), color=<span style="color: #2aa198;">'black'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/065351bf84cc072cfea4501c7663e8833e62bb33.png" alt="065351bf84cc072cfea4501c7663e8833e62bb33.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org02ebea1" class="outline-2">
<h2 id="org02ebea1"><span class="section-number-2">3</span> Pandas</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org0b1b2d8" class="outline-3">
<h3 id="org0b1b2d8"><span class="section-number-3">3.1</span> Series</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Series is like strong typed dictionary.
</p>

<p>
Series supports indexing with keys: <code>data['b']</code>
</p>

<p>
And checking presence with operator <code>in</code>: <code>'a' in data</code>
</p>
</div>

<div id="outline-container-org04631be" class="outline-4">
<h4 id="org04631be"><span class="section-number-4">3.1.1</span> Constructing</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
data can be a scalar, which is repeated to fill the specified index:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">pd.Series(5, index=[100, 200, 300])
</pre>
</div>

<pre class="example">
100    5
200    5
300    5
dtype: int64

</pre>

<p>
data can be a dictionary:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">pd.Series({2:<span style="color: #2aa198;">'a'</span>, 1:<span style="color: #2aa198;">'b'</span>, 3:<span style="color: #2aa198;">'c'</span>})
</pre>
</div>

<pre class="example">
2    a
1    b
3    c
dtype: object

</pre>

<p>
Explicitly specify index:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">pd.Series({2:<span style="color: #2aa198;">'a'</span>, 1:<span style="color: #2aa198;">'b'</span>, 3:<span style="color: #2aa198;">'c'</span>}, index=[3, 2])
</pre>
</div>

<pre class="example">
3    c
2    a
dtype: object

</pre>

<p>
In above example, 'b' is dropped, as 1 is not in the index.
</p>
</div>
</div>
</div>

<div id="outline-container-org9e56ad3" class="outline-3">
<h3 id="org9e56ad3"><span class="section-number-3">3.2</span> DataFrame</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Similar to Series, but 2D, where both rows and columns have generalized
index.
</p>

<p>
It can be seen as a dictionary of column names to series.
</p>

<p>
Assume we have this DataFrame:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">area</span> = pd.Series({<span style="color: #2aa198;">'California'</span>: 423967, <span style="color: #2aa198;">'Texas'</span>: 695662,
                  <span style="color: #2aa198;">'New York'</span>: 141297, <span style="color: #2aa198;">'Florida'</span>: 170312,
                  <span style="color: #2aa198;">'Illinois'</span>: 149995})
<span style="color: #268bd2;">pop</span> = pd.Series({<span style="color: #2aa198;">'California'</span>: 38332521, <span style="color: #2aa198;">'Texas'</span>: 26448193,
                 <span style="color: #2aa198;">'New York'</span>: 19651127, <span style="color: #2aa198;">'Florida'</span>: 19552860,
                 <span style="color: #2aa198;">'Illinois'</span>: 12882135})
<span style="color: #268bd2;">data</span> = pd.DataFrame({<span style="color: #2aa198;">'area'</span>:area, <span style="color: #2aa198;">'pop'</span>:pop})
data
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">423967</td>
<td class="org-right">38332521</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">695662</td>
<td class="org-right">26448193</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">141297</td>
<td class="org-right">19651127</td>
</tr>

<tr>
<td class="org-left">Florida</td>
<td class="org-right">170312</td>
<td class="org-right">19552860</td>
</tr>

<tr>
<td class="org-left">Illinois</td>
<td class="org-right">149995</td>
<td class="org-right">12882135</td>
</tr>
</tbody>
</table>

<p>
Access columns like dictionary:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">data[<span style="color: #2aa198;">'area'</span>] <span style="color: #586e75;"># </span><span style="color: #586e75;">or just data.area</span>
</pre>
</div>

<pre class="example">
California    423967
Texas         695662
New York      141297
Florida       170312
Illinois      149995
Name: area, dtype: int64

</pre>

<p>
Never assign columns via attribute syntax. For example, use <code>data['pop'] = z</code>
rather than <code>data.pop = z</code>. Otherwise it can overwrite method names.
</p>

<p>
Adding new column:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">data</span>[<span style="color: #2aa198;">'density'</span>] = data[<span style="color: #2aa198;">'pop'</span>] / data[<span style="color: #2aa198;">'area'</span>]
data
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
<th scope="col" class="org-right">density</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">423967</td>
<td class="org-right">38332521</td>
<td class="org-right">90.413926</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">695662</td>
<td class="org-right">26448193</td>
<td class="org-right">38.018740</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">141297</td>
<td class="org-right">19651127</td>
<td class="org-right">139.076746</td>
</tr>

<tr>
<td class="org-left">Florida</td>
<td class="org-right">170312</td>
<td class="org-right">19552860</td>
<td class="org-right">114.806121</td>
</tr>

<tr>
<td class="org-left">Illinois</td>
<td class="org-right">149995</td>
<td class="org-right">12882135</td>
<td class="org-right">85.883763</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org9aa2b43" class="outline-4">
<h4 id="org9aa2b43"><span class="section-number-4">3.2.1</span> Indexing DataFrames</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Indexing as NumPy array:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">data.iloc[:3, :2]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">423967</td>
<td class="org-right">38332521</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">695662</td>
<td class="org-right">26448193</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">141297</td>
<td class="org-right">19651127</td>
</tr>
</tbody>
</table>

<p>
Indexing with column and row names:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">data.loc[:<span style="color: #2aa198;">'Illinois'</span>, :<span style="color: #2aa198;">'pop'</span>]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">423967</td>
<td class="org-right">38332521</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">695662</td>
<td class="org-right">26448193</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">141297</td>
<td class="org-right">19651127</td>
</tr>

<tr>
<td class="org-left">Florida</td>
<td class="org-right">170312</td>
<td class="org-right">19552860</td>
</tr>

<tr>
<td class="org-left">Illinois</td>
<td class="org-right">149995</td>
<td class="org-right">12882135</td>
</tr>
</tbody>
</table>

<p>
<b>While indexing refers to columns, slicing refers to rows:</b>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">data[<span style="color: #2aa198;">'Florida'</span>:<span style="color: #2aa198;">'Illinois'</span>]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
<th scope="col" class="org-right">density</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Florida</td>
<td class="org-right">170312</td>
<td class="org-right">19552860</td>
<td class="org-right">114.806121</td>
</tr>

<tr>
<td class="org-left">Illinois</td>
<td class="org-right">149995</td>
<td class="org-right">12882135</td>
<td class="org-right">85.883763</td>
</tr>
</tbody>
</table>

<p>
<b>Such slices can also refer to rows by number rather than by index::</b>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">data[1:3]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">area</th>
<th scope="col" class="org-right">pop</th>
<th scope="col" class="org-right">density</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Texas</td>
<td class="org-right">695662</td>
<td class="org-right">26448193</td>
<td class="org-right">38.018740</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">141297</td>
<td class="org-right">19651127</td>
<td class="org-right">139.076746</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5303931" class="outline-4">
<h4 id="org5303931"><span class="section-number-4">3.2.2</span> Operations</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
All NumPy ufuncs work on Series and DataFrames, and indexes are preserved.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df</span> = pd.DataFrame(np.random.randint(0, 10, (3, 4)),
                  columns=[<span style="color: #2aa198;">'A'</span>, <span style="color: #2aa198;">'B'</span>, <span style="color: #2aa198;">'C'</span>, <span style="color: #2aa198;">'D'</span>])
np.sin(df * np.pi / 4)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">A</th>
<th scope="col" class="org-right">B</th>
<th scope="col" class="org-right">C</th>
<th scope="col" class="org-right">D</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">7.071068e-01</td>
<td class="org-right">1.000000e+00</td>
<td class="org-right">-1.000000e+00</td>
<td class="org-right">0.707107</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">-2.449294e-16</td>
<td class="org-right">1.000000e+00</td>
<td class="org-right">1.224647e-16</td>
<td class="org-right">1.000000</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">-1.000000e+00</td>
<td class="org-right">1.224647e-16</td>
<td class="org-right">-2.449294e-16</td>
<td class="org-right">-1.000000</td>
</tr>
</tbody>
</table>

<p>
<b>Pandas automatically aligns indexes, and fills missing data with NaN</b>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">area</span> = pd.Series({<span style="color: #2aa198;">'Alaska'</span>: 1723337, <span style="color: #2aa198;">'Texas'</span>: 695662,
                  <span style="color: #2aa198;">'California'</span>: 423967}, name=<span style="color: #2aa198;">'area'</span>)
<span style="color: #268bd2;">population</span> = pd.Series({<span style="color: #2aa198;">'California'</span>: 38332521, <span style="color: #2aa198;">'Texas'</span>: 26448193,
                        <span style="color: #2aa198;">'New York'</span>: 19651127}, name=<span style="color: #2aa198;">'population'</span>)
population / area
</pre>
</div>

<pre class="example">
Alaska              NaN
California    90.413926
New York            NaN
Texas         38.018740
dtype: float64

</pre>

<p>
This works because the resulting array contains the union of the indices of
the inputs:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">area.index | population.index
</pre>
</div>

<pre class="example">
Index(['Alaska', 'California', 'New York', 'Texas'], dtype='object')

</pre>

<p>
We can change the fill value: <code>A.add(B, fill_value=0)</code>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Python Operator</th>
<th scope="col" class="org-left">Pandas Method(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">+</td>
<td class="org-left">add()</td>
</tr>

<tr>
<td class="org-left">-</td>
<td class="org-left">sub(), subtract()</td>
</tr>

<tr>
<td class="org-left">*</td>
<td class="org-left">mul(), multiply()</td>
</tr>

<tr>
<td class="org-left">//</td>
<td class="org-left">floordiv()</td>
</tr>

<tr>
<td class="org-left">%</td>
<td class="org-left">mod()</td>
</tr>

<tr>
<td class="org-left">**</td>
<td class="org-left">pow()</td>
</tr>
</tbody>
</table>

<p>
Operations between DataFrame and Series are by default by rows. To make it
work by columns, use the above functions and specify axis (0=column, 1= row)
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df</span> = pd.DataFrame(np.random.randint(10, size=(3, 4)), columns=<span style="color: #839496; font-weight: bold;">list</span>(<span style="color: #2aa198;">'QRST'</span>))
<span style="color: #586e75;">#</span><span style="color: #586e75;">df - df.iloc[0] # first row becomes 0, other rows minus row0</span>
<span style="color: #586e75;">#</span><span style="color: #586e75;">df - df.Q       # this is not what you think</span>
df.subtract(df[<span style="color: #2aa198;">'Q'</span>], axis=0)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Q</th>
<th scope="col" class="org-right">R</th>
<th scope="col" class="org-right">S</th>
<th scope="col" class="org-right">T</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">7</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">-1</td>
<td class="org-right">0</td>
<td class="org-right">-5</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orge2db4f7" class="outline-3">
<h3 id="orge2db4f7"><span class="section-number-3">3.3</span> Missing data</h3>
<div class="outline-text-3" id="text-3-3">
<p>
NaN is often used. NumPy has functions to work on them.
</p>
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">vals2</span> = np.array([1, np.nan, 3, 4])
np.nansum(vals2), np.nanmin(vals2), np.nanmax(vals2)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">8.0</td>
<td class="org-right">1.0</td>
<td class="org-right">4.0</td>
</tr>
</tbody>
</table>

<p>
Pandas auto cast data to float when it needs to use NaN to represent missing
data.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = pd.Series(<span style="color: #839496; font-weight: bold;">range</span>(2), dtype=<span style="color: #839496; font-weight: bold;">int</span>)
<span style="color: #268bd2;">x</span>[0] = <span style="color: #268bd2; font-weight: bold;">None</span>
x
</pre>
</div>

<pre class="example">
0    NaN
1    1.0
dtype: float64

</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Typeclass</th>
<th scope="col" class="org-left">Conversion When Storing NAs</th>
<th scope="col" class="org-left">NA Sentinel Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">floating</td>
<td class="org-left">No change</td>
<td class="org-left">np.nan</td>
</tr>

<tr>
<td class="org-left">object</td>
<td class="org-left">No change</td>
<td class="org-left">None or np.nan</td>
</tr>

<tr>
<td class="org-left">integer</td>
<td class="org-left">Cast to float64</td>
<td class="org-left">np.nan</td>
</tr>

<tr>
<td class="org-left">boolean</td>
<td class="org-left">Cast to object</td>
<td class="org-left">None or np.nan</td>
</tr>
</tbody>
</table>

<p>
Pandas functions for NaN (or None, they are interchangeable in Pandas)
</p>

<ul class="org-ul">
<li><code>isnull()</code>: Generate a boolean mask indicating missing values</li>
<li><code>notnull()</code>: Opposite of isnull()</li>
<li><code>dropna()</code>: Return a filtered version of the data
<ul class="org-ul">
<li>Can drop entire row or column with 'axis'</li>
<li>Can set threshold of dropping row or column with 'thresh'</li>
</ul></li>
<li><code>fillna()</code>: Return a copy of the data with missing values filled or imputed
<ul class="org-ul">
<li>Can forward fill with <code>method='ffill'</code> and back fill with <code>method='bfill'</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org4f033e0" class="outline-3">
<h3 id="org4f033e0"><span class="section-number-3">3.4</span> Hierarchical Indexing</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">index</span> = [(<span style="color: #2aa198;">'California'</span>, 2000),
         (<span style="color: #2aa198;">'California'</span>, 2010),
         (<span style="color: #2aa198;">'New York'</span>, 2000),
         (<span style="color: #2aa198;">'New York'</span>, 2010),
         (<span style="color: #2aa198;">'Texas'</span>, 2000),
         (<span style="color: #2aa198;">'Texas'</span>, 2010)]
<span style="color: #268bd2;">populations</span> = [33871648, 37253956,
               18976457, 19378102,
               20851820, 25145561]
<span style="color: #268bd2;">pop</span> = pd.Series(populations, index=index)
<span style="color: #268bd2;">index</span> = pd.MultiIndex.from_tuples(index)
<span style="color: #268bd2;">pop</span> = pop.reindex(index)
pop
</pre>
</div>

<pre class="example">
California  2000    33871648
            2010    37253956
New York    2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64

</pre>

<p>
Unstack the last index column to create a new dimension
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">pop_df</span> = pop.unstack()
pop_df
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">2000</th>
<th scope="col" class="org-right">2010</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">33871648</td>
<td class="org-right">37253956</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">18976457</td>
<td class="org-right">19378102</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">20851820</td>
<td class="org-right">25145561</td>
</tr>
</tbody>
</table>

<p>
<b>Each extra level in a multi-index represents an extra dimension of data</b>
</p>

<p>
This allows us to easily and quickly manipulate and explore even
high-dimensional data.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">pop_df</span> = pd.DataFrame({<span style="color: #2aa198;">'total'</span>: pop,
                   <span style="color: #2aa198;">'under18'</span>: [9267089, 9284094,
                               4687374, 4318033,
                               5906301, 6879014]})
<span style="color: #268bd2;">f_u18</span> = pop_df[<span style="color: #2aa198;">'under18'</span>] / pop_df[<span style="color: #2aa198;">'total'</span>]
f_u18.unstack()
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">2000</th>
<th scope="col" class="org-right">2010</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">California</td>
<td class="org-right">0.273594</td>
<td class="org-right">0.249211</td>
</tr>

<tr>
<td class="org-left">New York</td>
<td class="org-right">0.247010</td>
<td class="org-right">0.222831</td>
</tr>

<tr>
<td class="org-left">Texas</td>
<td class="org-right">0.283251</td>
<td class="org-right">0.273568</td>
</tr>
</tbody>
</table>

<p>
Multi index levels can have names
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">pop.index.names</span> = [<span style="color: #2aa198;">'state'</span>, <span style="color: #2aa198;">'year'</span>]
pop
</pre>
</div>

<pre class="example">
state       year
California  2000    33871648
            2010    37253956
New York    2000    18976457
            2010    19378102
Texas       2000    20851820
            2010    25145561
dtype: int64

</pre>

<p>
Columns can have multiindex too
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #586e75;"># </span><span style="color: #586e75;">hierarchical indices and columns</span>
<span style="color: #268bd2;">index</span> = pd.MultiIndex.from_product([[2013, 2014], [1, 2]],
                                   names=[<span style="color: #2aa198;">'year'</span>, <span style="color: #2aa198;">'visit'</span>])
<span style="color: #268bd2;">columns</span> = pd.MultiIndex.from_product([[<span style="color: #2aa198;">'Bob'</span>, <span style="color: #2aa198;">'Guido'</span>, <span style="color: #2aa198;">'Sue'</span>], [<span style="color: #2aa198;">'HR'</span>, <span style="color: #2aa198;">'Temp'</span>]],
                                     names=[<span style="color: #2aa198;">'subject'</span>, <span style="color: #2aa198;">'type'</span>])

<span style="color: #586e75;"># </span><span style="color: #586e75;">mock some data</span>
<span style="color: #268bd2;">data</span> = np.<span style="color: #839496; font-weight: bold;">round</span>(np.random.randn(4, 6), 1)
<span style="color: #268bd2;">data</span>[:, ::2] *= 10
<span style="color: #268bd2;">data</span> += 37

<span style="color: #586e75;"># </span><span style="color: #586e75;">create the DataFrame</span>
<span style="color: #268bd2;">health_data</span> = pd.DataFrame(data, index=index, columns=columns)
health_data
</pre>
</div>

<pre class="example">
subject      Bob       Guido         Sue      
type          HR  Temp    HR  Temp    HR  Temp
year visit                                    
2013 1      45.0  35.8  39.0  35.0  24.0  37.2
     2      44.0  37.2  36.0  36.7  22.0  36.3
2014 1      32.0  38.1  40.0  35.2  40.0  36.6
     2      30.0  37.6  47.0  37.9  29.0  36.7

</pre>

<p>
This is fundamentally four-dimensional data.
</p>

<p>
The screen is 2D, Pandas can only present data in 2D on the screen.
</p>

<p>
stack() and unstack() essentially moves index between row and column, to
project the data to 2D in different ways.
</p>

<p>
Multiindex levels can be used for data aggregation.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">health_data.mean(level=<span style="color: #2aa198;">'visit'</span>)
</pre>
</div>

<pre class="example">
subject   Bob        Guido         Sue      
type       HR   Temp    HR  Temp    HR  Temp
visit                                       
1        38.5  36.95  39.5  35.1  32.0  36.9
2        37.0  37.40  41.5  37.3  25.5  36.5

</pre>

<p>
Also by column:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">health_data.mean(axis=1, level=<span style="color: #2aa198;">'type'</span>)
</pre>
</div>

<pre class="example">
type               HR       Temp
year visit                      
2013 1      36.000000  36.000000
     2      34.000000  36.733333
2014 1      37.333333  36.633333
     2      35.333333  37.400000

</pre>
</div>
</div>

<div id="outline-container-orge5ecfd9" class="outline-3">
<h3 id="orge5ecfd9"><span class="section-number-3">3.5</span> Merge and join</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Pandas automatically recognize overlapping columns
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df1</span> = pd.DataFrame({<span style="color: #2aa198;">'employee'</span>: [<span style="color: #2aa198;">'Bob'</span>, <span style="color: #2aa198;">'Jake'</span>, <span style="color: #2aa198;">'Lisa'</span>, <span style="color: #2aa198;">'Sue'</span>],
                    <span style="color: #2aa198;">'group'</span>: [<span style="color: #2aa198;">'Accounting'</span>, <span style="color: #2aa198;">'Engineering'</span>, <span style="color: #2aa198;">'Engineering'</span>, <span style="color: #2aa198;">'HR'</span>]})
<span style="color: #268bd2;">df2</span> = pd.DataFrame({<span style="color: #2aa198;">'employee'</span>: [<span style="color: #2aa198;">'Lisa'</span>, <span style="color: #2aa198;">'Bob'</span>, <span style="color: #2aa198;">'Jake'</span>, <span style="color: #2aa198;">'Sue'</span>],
                    <span style="color: #2aa198;">'hire_date'</span>: [2004, 2008, 2012, 2014]})
pd.merge(df1, df2)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">employee</th>
<th scope="col" class="org-left">group</th>
<th scope="col" class="org-right">hire<sub>date</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">Bob</td>
<td class="org-left">Accounting</td>
<td class="org-right">2008</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Jake</td>
<td class="org-left">Engineering</td>
<td class="org-right">2012</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Lisa</td>
<td class="org-left">Engineering</td>
<td class="org-right">2004</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Sue</td>
<td class="org-left">HR</td>
<td class="org-right">2014</td>
</tr>
</tbody>
</table>

<p>
Merge key can be explicitly specified:
</p>

<p>
<code>pd.merge(df1, df2, on='employee')</code>
</p>

<p>
If column names differ, use <code>left_on</code> and <code>right_on</code> to specify the columns.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df3</span> = pd.DataFrame({<span style="color: #2aa198;">'name'</span>: [<span style="color: #2aa198;">'Bob'</span>, <span style="color: #2aa198;">'Jake'</span>, <span style="color: #2aa198;">'Lisa'</span>, <span style="color: #2aa198;">'Sue'</span>],
                    <span style="color: #2aa198;">'salary'</span>: [70000, 80000, 120000, 90000]})
<span style="color: #586e75;"># </span><span style="color: #586e75;">drop() to remove the duplicated column</span>
pd.merge(df1, df3, left_on=<span style="color: #2aa198;">"employee"</span>, right_on=<span style="color: #2aa198;">"name"</span>).drop(<span style="color: #2aa198;">"name"</span>, axis=1)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">employee</th>
<th scope="col" class="org-left">group</th>
<th scope="col" class="org-right">salary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">Bob</td>
<td class="org-left">Accounting</td>
<td class="org-right">70000</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Jake</td>
<td class="org-left">Engineering</td>
<td class="org-right">80000</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Lisa</td>
<td class="org-left">Engineering</td>
<td class="org-right">120000</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Sue</td>
<td class="org-left">HR</td>
<td class="org-right">90000</td>
</tr>
</tbody>
</table>

<p>
merge() can use indices too:
<code>pd.merge(df1, df2, left_index=True, right_index=True)</code>
</p>

<p>
But for convenience, use join(), which performs merge that defaults to
joining on indices.
</p>
</div>

<div id="outline-container-org4e8623c" class="outline-4">
<h4 id="org4e8623c"><span class="section-number-4">3.5.1</span> Specifying Set Arithmetic for Joins</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
By default, merge produces <b>intersection</b> of the inputs(inner join)
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df6</span> = pd.DataFrame({<span style="color: #2aa198;">'name'</span>: [<span style="color: #2aa198;">'Peter'</span>, <span style="color: #2aa198;">'Paul'</span>, <span style="color: #2aa198;">'Mary'</span>],
                    <span style="color: #2aa198;">'food'</span>: [<span style="color: #2aa198;">'fish'</span>, <span style="color: #2aa198;">'beans'</span>, <span style="color: #2aa198;">'bread'</span>]},
                   columns=[<span style="color: #2aa198;">'name'</span>, <span style="color: #2aa198;">'food'</span>])
<span style="color: #268bd2;">df7</span> = pd.DataFrame({<span style="color: #2aa198;">'name'</span>: [<span style="color: #2aa198;">'Mary'</span>, <span style="color: #2aa198;">'Joseph'</span>],
                    <span style="color: #2aa198;">'drink'</span>: [<span style="color: #2aa198;">'wine'</span>, <span style="color: #2aa198;">'beer'</span>]},
                   columns=[<span style="color: #2aa198;">'name'</span>, <span style="color: #2aa198;">'drink'</span>])
pd.merge(df6, df7)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">name</th>
<th scope="col" class="org-left">food</th>
<th scope="col" class="org-left">drink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">Mary</td>
<td class="org-left">bread</td>
<td class="org-left">wine</td>
</tr>
</tbody>
</table>


<p>
To make a outer join, use the <code>how</code> keyword (how can also be <code>left</code> or
<code>right</code>):
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">pd.merge(df6, df7, how=<span style="color: #2aa198;">'outer'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">name</th>
<th scope="col" class="org-left">food</th>
<th scope="col" class="org-left">drink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">Peter</td>
<td class="org-left">fish</td>
<td class="org-left">NaN</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Paul</td>
<td class="org-left">beans</td>
<td class="org-left">NaN</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Mary</td>
<td class="org-left">bread</td>
<td class="org-left">wine</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Joseph</td>
<td class="org-left">NaN</td>
<td class="org-left">beer</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org2f0ba9b" class="outline-3">
<h3 id="org2f0ba9b"><span class="section-number-3">3.6</span> Aggregation and grouping</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Use the seaborn planets dataset as example
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #859900; font-weight: bold;">import</span> seaborn <span style="color: #859900; font-weight: bold;">as</span> sns
<span style="color: #268bd2;">planets</span> = sns.load_dataset(<span style="color: #2aa198;">'planets'</span>)
planets.shape
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1035</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>

<p>
DataFrame has convenience method <code>describe()</code>, that computes several common
aggregates for each column.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">planets.dropna().describe()
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">number</th>
<th scope="col" class="org-right">orbital<sub>period</sub></th>
<th scope="col" class="org-right">mass</th>
<th scope="col" class="org-right">distance</th>
<th scope="col" class="org-right">year</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count</td>
<td class="org-right">498.00000</td>
<td class="org-right">498.000000</td>
<td class="org-right">498.000000</td>
<td class="org-right">498.000000</td>
<td class="org-right">498.000000</td>
</tr>

<tr>
<td class="org-left">mean</td>
<td class="org-right">1.73494</td>
<td class="org-right">835.778671</td>
<td class="org-right">2.509320</td>
<td class="org-right">52.068213</td>
<td class="org-right">2007.377510</td>
</tr>

<tr>
<td class="org-left">std</td>
<td class="org-right">1.17572</td>
<td class="org-right">1469.128259</td>
<td class="org-right">3.636274</td>
<td class="org-right">46.596041</td>
<td class="org-right">4.167284</td>
</tr>

<tr>
<td class="org-left">min</td>
<td class="org-right">1.00000</td>
<td class="org-right">1.328300</td>
<td class="org-right">0.003600</td>
<td class="org-right">1.350000</td>
<td class="org-right">1989.000000</td>
</tr>

<tr>
<td class="org-left">25%</td>
<td class="org-right">1.00000</td>
<td class="org-right">38.272250</td>
<td class="org-right">0.212500</td>
<td class="org-right">24.497500</td>
<td class="org-right">2005.000000</td>
</tr>

<tr>
<td class="org-left">50%</td>
<td class="org-right">1.00000</td>
<td class="org-right">357.000000</td>
<td class="org-right">1.245000</td>
<td class="org-right">39.940000</td>
<td class="org-right">2009.000000</td>
</tr>

<tr>
<td class="org-left">75%</td>
<td class="org-right">2.00000</td>
<td class="org-right">999.600000</td>
<td class="org-right">2.867500</td>
<td class="org-right">59.332500</td>
<td class="org-right">2011.000000</td>
</tr>

<tr>
<td class="org-left">max</td>
<td class="org-right">6.00000</td>
<td class="org-right">17337.500000</td>
<td class="org-right">25.000000</td>
<td class="org-right">354.000000</td>
<td class="org-right">2014.000000</td>
</tr>
</tbody>
</table>

<p>
Other built-in Pandas aggregations:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Aggregation</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count()</td>
<td class="org-left">Total number of items</td>
</tr>

<tr>
<td class="org-left">first(), last()</td>
<td class="org-left">First and last item</td>
</tr>

<tr>
<td class="org-left">mean(), median()</td>
<td class="org-left">Mean and median</td>
</tr>

<tr>
<td class="org-left">min(), max()</td>
<td class="org-left">Minimum and maximum</td>
</tr>

<tr>
<td class="org-left">std(), var()</td>
<td class="org-left">Standard deviation and variance</td>
</tr>

<tr>
<td class="org-left">mad()</td>
<td class="org-left">Mean absolute deviation</td>
</tr>

<tr>
<td class="org-left">prod()</td>
<td class="org-left">Product of all items</td>
</tr>

<tr>
<td class="org-left">sum()</td>
<td class="org-left">Sum of all items</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org0aebcc3" class="outline-4">
<h4 id="org0aebcc3"><span class="section-number-4">3.6.1</span> GroupBy</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
The <code>GroupBy</code> object can be seen as a collection of ~DataFrame~s
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">planets.groupby(<span style="color: #2aa198;">'method'</span>)[<span style="color: #2aa198;">'orbital_period'</span>].median()
</pre>
</div>

<pre class="example">
method
Astrometry                         631.180000
Eclipse Timing Variations         4343.500000
Imaging                          27500.000000
Microlensing                      3300.000000
Orbital Brightness Modulation        0.342887
Pulsar Timing                       66.541900
Pulsation Timing Variations       1170.000000
Radial Velocity                    360.200000
Transit                              5.714932
Transit Timing Variations           57.011000
Name: orbital_period, dtype: float64
</pre>

<p>
The <code>GroupBy</code> object supports iteration over groups:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #859900; font-weight: bold;">for</span> (method, group) <span style="color: #859900; font-weight: bold;">in</span> planets.groupby(<span style="color: #2aa198;">'method'</span>):
    <span style="color: #859900; font-weight: bold;">print</span>(<span style="color: #2aa198;">"{0:30s} shape={1}"</span>.<span style="color: #839496; font-weight: bold;">format</span>(method, group.shape))
</pre>
</div>

<pre class="example">
Astrometry                     shape=(2, 6)
Eclipse Timing Variations      shape=(9, 6)
Imaging                        shape=(38, 6)
Microlensing                   shape=(23, 6)
Orbital Brightness Modulation  shape=(3, 6)
Pulsar Timing                  shape=(5, 6)
Pulsation Timing Variations    shape=(1, 6)
Radial Velocity                shape=(553, 6)
Transit                        shape=(397, 6)
Transit Timing Variations      shape=(4, 6)

</pre>

<p>
The <code>GroupBy</code> object pass through methods to its groups:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">planets.groupby(<span style="color: #2aa198;">'method'</span>)[<span style="color: #2aa198;">'year'</span>].describe()
</pre>
</div>

<pre class="example">
                               count         mean       std     min      25%  \
method                                                                         
Astrometry                       2.0  2011.500000  2.121320  2010.0  2010.75   
Eclipse Timing Variations        9.0  2010.000000  1.414214  2008.0  2009.00   
Imaging                         38.0  2009.131579  2.781901  2004.0  2008.00   
Microlensing                    23.0  2009.782609  2.859697  2004.0  2008.00   
Orbital Brightness Modulation    3.0  2011.666667  1.154701  2011.0  2011.00   
Pulsar Timing                    5.0  1998.400000  8.384510  1992.0  1992.00   
Pulsation Timing Variations      1.0  2007.000000       NaN  2007.0  2007.00   
Radial Velocity                553.0  2007.518987  4.249052  1989.0  2005.00   
Transit                        397.0  2011.236776  2.077867  2002.0  2010.00   
Transit Timing Variations        4.0  2012.500000  1.290994  2011.0  2011.75   

                                  50%      75%     max  
method                                                  
Astrometry                     2011.5  2012.25  2013.0  
Eclipse Timing Variations      2010.0  2011.00  2012.0  
Imaging                        2009.0  2011.00  2013.0  
Microlensing                   2010.0  2012.00  2013.0  
Orbital Brightness Modulation  2011.0  2012.00  2013.0  
Pulsar Timing                  1994.0  2003.00  2011.0  
Pulsation Timing Variations    2007.0  2007.00  2007.0  
Radial Velocity                2009.0  2011.00  2014.0  
Transit                        2012.0  2013.00  2014.0  
Transit Timing Variations      2012.5  2013.25  2014.0  
</pre>

<p>
Filter out groups with <code>filter()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">df</span> = pd.DataFrame({<span style="color: #2aa198;">'A'</span> : [<span style="color: #2aa198;">'foo'</span>, <span style="color: #2aa198;">'bar'</span>, <span style="color: #2aa198;">'foo'</span>, <span style="color: #2aa198;">'bar'</span>,
                          <span style="color: #2aa198;">'foo'</span>, <span style="color: #2aa198;">'bar'</span>],
                   <span style="color: #2aa198;">'B'</span> : [1, 2, 3, 4, 5, 6],
                   <span style="color: #2aa198;">'C'</span> : [2.0, 5., 8., 1., 2., 9.]})
df.groupby(<span style="color: #2aa198;">'A'</span>).<span style="color: #839496; font-weight: bold;">filter</span>(<span style="color: #859900; font-weight: bold;">lambda</span> x: x[<span style="color: #2aa198;">'B'</span>].mean() &gt; 3.)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">A</th>
<th scope="col" class="org-right">B</th>
<th scope="col" class="org-right">C</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">bar</td>
<td class="org-right">2</td>
<td class="org-right">5.0</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">bar</td>
<td class="org-right">4</td>
<td class="org-right">1.0</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">bar</td>
<td class="org-right">6</td>
<td class="org-right">9.0</td>
</tr>
</tbody>
</table>

<p>
Or more complex things with <code>transform()</code> and <code>apply()</code>.
</p>

<p>
<code>groupby()</code> also accepts dictionary and python functions.
</p>
</div>
</div>

<div id="outline-container-orgab21ac4" class="outline-4">
<h4 id="orgab21ac4"><span class="section-number-4">3.6.2</span> Pivot tables</h4>
<div class="outline-text-4" id="text-3-6-2">
<p>
Use titanic data set:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">titanic</span> = sns.load_dataset(<span style="color: #2aa198;">'titanic'</span>)
titanic.head()
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">survived</th>
<th scope="col" class="org-right">pclass</th>
<th scope="col" class="org-left">sex</th>
<th scope="col" class="org-right">age</th>
<th scope="col" class="org-right">sibsp</th>
<th scope="col" class="org-right">parch</th>
<th scope="col" class="org-right">fare</th>
<th scope="col" class="org-left">embarked</th>
<th scope="col" class="org-left">class</th>
<th scope="col" class="org-left">who</th>
<th scope="col" class="org-left">adult<sub>male</sub></th>
<th scope="col" class="org-right">deck</th>
<th scope="col" class="org-left">embark<sub>town</sub></th>
<th scope="col" class="org-left">alive</th>
<th scope="col" class="org-left">alone</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-left">male</td>
<td class="org-right">22.0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">7.2500</td>
<td class="org-left">S</td>
<td class="org-left">Third</td>
<td class="org-left">man</td>
<td class="org-left">True</td>
<td class="org-right">NaN</td>
<td class="org-left">Southampton</td>
<td class="org-left">no</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">female</td>
<td class="org-right">38.0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">71.2833</td>
<td class="org-left">C</td>
<td class="org-left">First</td>
<td class="org-left">woman</td>
<td class="org-left">False</td>
<td class="org-right">C</td>
<td class="org-left">Cherbourg</td>
<td class="org-left">yes</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-left">female</td>
<td class="org-right">26.0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">7.9250</td>
<td class="org-left">S</td>
<td class="org-left">Third</td>
<td class="org-left">woman</td>
<td class="org-left">False</td>
<td class="org-right">NaN</td>
<td class="org-left">Southampton</td>
<td class="org-left">yes</td>
<td class="org-left">True</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">female</td>
<td class="org-right">35.0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">53.1000</td>
<td class="org-left">S</td>
<td class="org-left">First</td>
<td class="org-left">woman</td>
<td class="org-left">False</td>
<td class="org-right">C</td>
<td class="org-left">Southampton</td>
<td class="org-left">yes</td>
<td class="org-left">False</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-left">male</td>
<td class="org-right">35.0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">8.0500</td>
<td class="org-left">S</td>
<td class="org-left">Third</td>
<td class="org-left">man</td>
<td class="org-left">True</td>
<td class="org-right">NaN</td>
<td class="org-left">Southampton</td>
<td class="org-left">no</td>
<td class="org-left">True</td>
</tr>
</tbody>
</table>

<p>
Pivot table the manual way, two column <code>groupby()</code> then <code>unstack()</code>:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">titanic.groupby([<span style="color: #2aa198;">'sex'</span>, <span style="color: #2aa198;">'class'</span>])[<span style="color: #2aa198;">'survived'</span>].mean().unstack()
</pre>
</div>

<pre class="example">
class      First    Second     Third
sex                                 
female  0.968085  0.921053  0.500000
male    0.368852  0.157407  0.135447

</pre>

<p>
Pivot table syntax:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">titanic.pivot_table(<span style="color: #2aa198;">'survived'</span>, index=<span style="color: #2aa198;">'sex'</span>, columns=<span style="color: #2aa198;">'class'</span>)
</pre>
</div>

<pre class="example">
class      First    Second     Third
sex                                 
female  0.968085  0.921053  0.500000
male    0.368852  0.157407  0.135447

</pre>

<p>
Multi-level pivot tables:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">age</span> = pd.cut(titanic[<span style="color: #2aa198;">'age'</span>], [0, 18, 80])
titanic.pivot_table(<span style="color: #2aa198;">'survived'</span>, [<span style="color: #2aa198;">'sex'</span>, age], <span style="color: #2aa198;">'class'</span>)
</pre>
</div>

<pre class="example">
class               First    Second     Third
sex    age                                   
female (0, 18]   0.909091  1.000000  0.511628
       (18, 80]  0.972973  0.900000  0.423729
male   (0, 18]   0.800000  0.600000  0.215686
       (18, 80]  0.375000  0.071429  0.133663

</pre>

<p>
Multi-level column index:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">fare</span> = pd.qcut(titanic[<span style="color: #2aa198;">'fare'</span>], 2)
titanic.pivot_table(<span style="color: #2aa198;">'survived'</span>, [<span style="color: #2aa198;">'sex'</span>, age], [fare, <span style="color: #2aa198;">'class'</span>])
</pre>
</div>

<pre class="example">
fare            (-0.001, 14.454]                     (14.454, 512.329]  \
class                      First    Second     Third             First   
sex    age                                                               
female (0, 18]               NaN  1.000000  0.714286          0.909091   
       (18, 80]              NaN  0.880000  0.444444          0.972973   
male   (0, 18]               NaN  0.000000  0.260870          0.800000   
       (18, 80]              0.0  0.098039  0.125000          0.391304   

fare                                 
class              Second     Third  
sex    age                           
female (0, 18]   1.000000  0.318182  
       (18, 80]  0.914286  0.391304  
male   (0, 18]   0.818182  0.178571  
       (18, 80]  0.030303  0.192308  
</pre>

<p>
Include totals in <code>pivot_table()</code> with <code>margins</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">titanic.pivot_table(<span style="color: #2aa198;">'survived'</span>, index=<span style="color: #2aa198;">'sex'</span>, columns=<span style="color: #2aa198;">'class'</span>, margins=<span style="color: #268bd2; font-weight: bold;">True</span>)
</pre>
</div>

<pre class="example">
class      First    Second     Third       All
sex                                           
female  0.968085  0.921053  0.500000  0.742038
male    0.368852  0.157407  0.135447  0.188908
All     0.629630  0.472826  0.242363  0.383838

</pre>
</div>
</div>
</div>

<div id="outline-container-org6a48936" class="outline-3">
<h3 id="org6a48936"><span class="section-number-3">3.7</span> <span class="todo TODO">TODO</span> Working with time (reread this)</h3>
</div>
</div>

<div id="outline-container-orgeb5f052" class="outline-2">
<h2 id="orgeb5f052"><span class="section-number-2">4</span> Matplotlib</h2>
<div class="outline-text-2" id="text-4">
<p>
Matplotlib has two interfaces
</p>

<ul class="org-ul">
<li>A MATLIB-style state-based interface</li>
<li>And a more powerful object-oriented interface</li>
</ul>

<p>
Figure is a container of all objects (axes, graphics, text, labels)
</p>

<p>
Axes is a bounding box with ticks and labels, which will eventually contain
the plot elements.
</p>
</div>

<div id="outline-container-org0dd08a0" class="outline-3">
<h3 id="org0dd08a0"><span class="section-number-3">4.1</span> MATLAB-style interface</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The MATLAB-style tools are contained in the pyplot interface.
</p>

<p>
This interface is <b>stateful</b>: it keeps track of the "current" figure and
axes. These can be acquired from <code>plt.gcf()</code> (current figure) and <code>plt.gca()</code>
(current axes)
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.linspace(0, 10, 100)

plt.figure()  <span style="color: #586e75;"># </span><span style="color: #586e75;">create a plot figure</span>

<span style="color: #586e75;"># </span><span style="color: #586e75;">create the first of two panels and set current axis</span>
plt.subplot(2, 1, 1) <span style="color: #586e75;"># </span><span style="color: #586e75;">(rows, columns, panel number)</span>
plt.plot(x, np.sin(x))

<span style="color: #586e75;"># </span><span style="color: #586e75;">create the second panel and set current axis</span>
plt.subplot(2, 1, 2)
plt.plot(x, np.cos(x));
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/82335a76bf9d7b294fa6d9e9f20cf1ffce645f5b.png" alt="82335a76bf9d7b294fa6d9e9f20cf1ffce645f5b.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orge6a1d82" class="outline-3">
<h3 id="orge6a1d82"><span class="section-number-3">4.2</span> Object-oriented interface</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Plotting functions are methods of explicit <code>Figure</code> and <code>Axes</code> objects.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #586e75;"># </span><span style="color: #586e75;">First create a grid of plots</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">ax will be an array of two Axes objects</span>
<span style="color: #268bd2;">fig</span>, <span style="color: #268bd2;">ax</span> = plt.subplots(2)

<span style="color: #586e75;"># </span><span style="color: #586e75;">Call plot() method on the appropriate object</span>
ax[0].plot(x, np.sin(x))
ax[1].plot(x, np.cos(x));
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/82335a76bf9d7b294fa6d9e9f20cf1ffce645f5b.png" alt="82335a76bf9d7b294fa6d9e9f20cf1ffce645f5b.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org8ba08fb" class="outline-3">
<h3 id="org8ba08fb"><span class="section-number-3">4.3</span> Line plot</h3>
<div class="outline-text-3" id="text-4-3">
<p>
line style and color can be combined into a single non-keyword argument to
<code>plt.plot()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, x + 0, <span style="color: #2aa198;">'-g'</span>)  <span style="color: #586e75;"># </span><span style="color: #586e75;">solid green</span>
plt.plot(x, x + 1, <span style="color: #2aa198;">'--c'</span>) <span style="color: #586e75;"># </span><span style="color: #586e75;">dashed cyan</span>
plt.plot(x, x + 2, <span style="color: #2aa198;">'-.k'</span>) <span style="color: #586e75;"># </span><span style="color: #586e75;">dashdot black</span>
plt.plot(x, x + 3, <span style="color: #2aa198;">':r'</span>);  <span style="color: #586e75;"># </span><span style="color: #586e75;">dotted red</span>
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/a5cb9dc92dcf140e29987fbdc8d6227189899423.png" alt="a5cb9dc92dcf140e29987fbdc8d6227189899423.png" />
</p>
</div>

<p>
plot limits can be set with <code>xlim()</code> and <code>ylim()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, np.sin(x))
plt.xlim(-1, 11)
plt.ylim(-1.5, 1.5);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/f5d446e871eef9839c381f0dc8bc7c32c67bc269.png" alt="f5d446e871eef9839c381f0dc8bc7c32c67bc269.png" />
</p>
</div>

<p>
Reversing the order of the arguments makes axis to be displayed in reverse
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, np.sin(x))
plt.xlim(10, 0)
plt.ylim(1.2, -1.2);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/6b3a240887c9ed2973e77b73804e06faf4ef8844.png" alt="6b3a240887c9ed2973e77b73804e06faf4ef8844.png" />
</p>
</div>

<p>
<code>x</code> and <code>y</code> limits can also be set with a single call <code>plt.axis()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, np.sin(x))
plt.axis([-1, 11, -1.5, 1.5]);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/f5d446e871eef9839c381f0dc8bc7c32c67bc269.png" alt="f5d446e871eef9839c381f0dc8bc7c32c67bc269.png" />
</p>
</div>

<p>
<code>axis()</code> can ensure 1:1 aspect ratio (one unit of <code>x</code> is equal to one unit of
<code>y</code> on screen) :
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, np.sin(x))
plt.axis(<span style="color: #2aa198;">'equal'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/c87fd39705d9e70bb78ba2dee3dc84ceb6c2577c.png" alt="c87fd39705d9e70bb78ba2dee3dc84ceb6c2577c.png" />
</p>
</div>

<p>
Add title with <code>plt.title()</code>
</p>

<p>
Add axis labels with <code>plt.xlabel()</code> and <code>plt.ylabel()</code>
</p>

<p>
Add legend by specifying label of each line with the <code>label</code> keyword, then
call <code>plt.legend()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.plot(x, np.sin(x), <span style="color: #2aa198;">'-g'</span>, label=<span style="color: #2aa198;">'sin(x)'</span>)
plt.plot(x, np.cos(x), <span style="color: #2aa198;">':b'</span>, label=<span style="color: #2aa198;">'cos(x)'</span>)
plt.legend();
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/16f7c754874cf8618b628f32954e640a45cd0387.png" alt="16f7c754874cf8618b628f32954e640a45cd0387.png" />
</p>
</div>

<p>
most <code>plt</code> functions translate directly to <code>ax</code> methods. But some are not for
MATLAB compatibility:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">plt.xlabel()</td>
<td class="org-left">ax.set<sub>xlabel</sub>()</td>
</tr>

<tr>
<td class="org-left">plt.ylabel()</td>
<td class="org-left">ax.set<sub>ylabel</sub>()</td>
</tr>

<tr>
<td class="org-left">plt.xlim()</td>
<td class="org-left">ax.set<sub>xlim</sub>()</td>
</tr>

<tr>
<td class="org-left">plt.ylim()</td>
<td class="org-left">ax.set<sub>ylim</sub>()</td>
</tr>

<tr>
<td class="org-left">plt.title()</td>
<td class="org-left">ax.set<sub>title</sub>()</td>
</tr>
</tbody>
</table>

<p>
But it's usually more convenient to use <code>ax.set()</code> to set all properties at once:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">ax</span> = plt.axes()
ax.plot(x, np.sin(x))
ax.<span style="color: #839496; font-weight: bold;">set</span>(xlim=(0, 10), ylim=(-2, 2),
       xlabel=<span style="color: #2aa198;">'x'</span>, ylabel=<span style="color: #2aa198;">'sin(x)'</span>,
       title=<span style="color: #2aa198;">'A Simple Plot'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/5b3d6484ed7d81922699f4c76b9e6e9d5179b971.png" alt="5b3d6484ed7d81922699f4c76b9e6e9d5179b971.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orge97b90e" class="outline-3">
<h3 id="orge97b90e"><span class="section-number-3">4.4</span> Scatter plots</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Similar to line plot. Instead of points being joined by line segments, here
the points are represented individually with dots.
</p>

<p>
There are many different markers to choose from:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">rng</span> = np.random.RandomState(0)
<span style="color: #859900; font-weight: bold;">for</span> marker <span style="color: #859900; font-weight: bold;">in</span> [<span style="color: #2aa198;">'o'</span>, <span style="color: #2aa198;">'.'</span>, <span style="color: #2aa198;">','</span>, <span style="color: #2aa198;">'x'</span>, <span style="color: #2aa198;">'+'</span>, <span style="color: #2aa198;">'v'</span>, <span style="color: #2aa198;">'^'</span>, <span style="color: #2aa198;">'&lt;'</span>, <span style="color: #2aa198;">'&gt;'</span>, <span style="color: #2aa198;">'s'</span>, <span style="color: #2aa198;">'d'</span>, <span style="color: #2aa198;">'p'</span>, <span style="color: #2aa198;">'h'</span>]:
    plt.plot(rng.rand(5), rng.rand(5), marker,
             label=<span style="color: #2aa198;">"marker='{0}'"</span>.<span style="color: #839496; font-weight: bold;">format</span>(marker))
plt.legend(numpoints=1)
plt.xlim(0, 1.8);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/277d0589f268e5bfdde5153fd2c1ba1110413203.png" alt="277d0589f268e5bfdde5153fd2c1ba1110413203.png" />
</p>
</div>

<p>
dots and lines can be combined:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.linspace(0, 10, 30)
<span style="color: #268bd2;">y</span> = np.sin(x)
plt.plot(x, y, <span style="color: #2aa198;">'-o'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/567c012826881935637f11e8fda02edec335ee80.png" alt="567c012826881935637f11e8fda02edec335ee80.png" />
</p>
</div>

<p>
A more powerful method of creating scatter plots is <code>plt.scatter()</code>. It can
be used to create scatter plots where the properties of each point (size,
face color, edge color, etc.) can be individually controlled or mapped to
data.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">rng</span> = np.random.RandomState(0)
<span style="color: #268bd2;">x</span> = rng.randn(100)
<span style="color: #268bd2;">y</span> = rng.randn(100)
<span style="color: #268bd2;">colors</span> = rng.rand(100)
<span style="color: #268bd2;">sizes</span> = 1000 * rng.rand(100)
plt.scatter(x, y, c=colors, s=sizes, alpha=0.3,
            cmap=<span style="color: #2aa198;">'viridis'</span>)
plt.colorbar();  <span style="color: #586e75;"># </span><span style="color: #586e75;">show color scale</span>
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/d4120835b9596c2f66ffc29c0ae32fa323b74fac.png" alt="d4120835b9596c2f66ffc29c0ae32fa323b74fac.png" />
</p>
</div>

<p>
Color and size combined with X-Y let us explore four different dimension of
the data at the same time:
</p>

<p>
For large datasets, <code>plot()</code> is more efficient than <code>scatter()</code>
</p>
</div>
</div>

<div id="outline-container-orgfb76efb" class="outline-3">
<h3 id="orgfb76efb"><span class="section-number-3">4.5</span> Visualizing errors</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Draw errorbars graph with <code>plt.errorbar</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x</span> = np.linspace(0, 10, 50)
<span style="color: #268bd2;">dy</span> = 0.8
<span style="color: #268bd2;">y</span> = np.sin(x) + dy * np.random.randn(50)
plt.errorbar(x, y, yerr=dy, fmt=<span style="color: #2aa198;">'.'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/2e968b5cd5e68fa3190631613af5f09beb8bdd28.png" alt="2e968b5cd5e68fa3190631613af5f09beb8bdd28.png" />
</p>
</div>

<p>
Show continues error with <code>fill_between()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">y</span> = np.sin(x) + dy * np.random.randn(50)
plt.plot(x, y, <span style="color: #2aa198;">'-o'</span>);
plt.fill_between(x, y - 0.8, y+0.8, color=<span style="color: #2aa198;">'gray'</span>, alpha=0.2);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/58e85b5fe1b68c5c1bd95974e0a0156ca6ed156a.png" alt="58e85b5fe1b68c5c1bd95974e0a0156ca6ed156a.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org79b2876" class="outline-3">
<h3 id="org79b2876"><span class="section-number-3">4.6</span> Visualizing three-dimensional function with <code>contour()</code> and <code>imshow()</code></h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">f</span>(x, y):
    <span style="color: #859900; font-weight: bold;">return</span> np.sin(x) ** 10 + np.cos(10 + y * x) * np.cos(x)
<span style="color: #268bd2;">x</span> = np.linspace(0, 5, 50)
<span style="color: #268bd2;">y</span> = np.linspace(0, 5, 40)
<span style="color: #268bd2;">X</span>, <span style="color: #268bd2;">Y</span> = np.meshgrid(x, y)
<span style="color: #268bd2;">Z</span> = f(X, Y)
plt.contour(X, Y, Z, colors=<span style="color: #2aa198;">'black'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/62709be4dda2cf967f306e98fc73e088d4c08af9.png" alt="62709be4dda2cf967f306e98fc73e088d4c08af9.png" />
</p>
</div>

<p>
Or fill with color:
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.contourf(X, Y, Z, 10);      <span style="color: #586e75;"># </span><span style="color: #586e75;">10 steps</span>
plt.colorbar();                 <span style="color: #586e75;"># </span><span style="color: #586e75;">add legend</span>
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/e1eb8da15240d11ff18e9f7ea2697e0381f4e8b4.png" alt="e1eb8da15240d11ff18e9f7ea2697e0381f4e8b4.png" />
</p>
</div>

<p>
To get smooth image, use <code>imshow()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.imshow(Z, extent=[0, 5, 0, 5], origin=<span style="color: #2aa198;">'lower'</span>)
plt.colorbar();
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/bfa95f4f19db5e695c3dee7cf6339fbc7e080f47.png" alt="bfa95f4f19db5e695c3dee7cf6339fbc7e080f47.png" />
</p>
</div>

<p>
Combine contour and image, and add labels
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.imshow(Z, extent=[0, 5, 0, 5], origin=<span style="color: #2aa198;">'lower'</span>, alpha=0.7)
<span style="color: #268bd2;">contours</span> = plt.contour(X, Y, Z, 3, colors=<span style="color: #2aa198;">'black'</span>)
plt.clabel(contours, inline=<span style="color: #268bd2; font-weight: bold;">True</span>, fontsize=8)
plt.colorbar();
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/dba380219e8417d16f1a17f1e73326f7e18dce66.png" alt="dba380219e8417d16f1a17f1e73326f7e18dce66.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org827cc76" class="outline-3">
<h3 id="org827cc76"><span class="section-number-3">4.7</span> Histograms, Binnings, and Density</h3>
<div class="outline-text-3" id="text-4-7">
<p>
<code>histtype='stepfilled'</code> with some transparency <code>alpha</code> very useful when
comparing several histograms
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">x1</span> = np.random.normal(0, 0.8, 1000)
<span style="color: #268bd2;">x2</span> = np.random.normal(-2, 1, 1000)
<span style="color: #268bd2;">x3</span> = np.random.normal(3, 2, 1000)
<span style="color: #586e75;"># </span><span style="color: #586e75;">density=True shows probability density (the area or integral under the</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">histogram will sum to 1.)</span>
<span style="color: #268bd2;">kwargs</span> = <span style="color: #839496; font-weight: bold;">dict</span>(histtype=<span style="color: #2aa198;">'stepfilled'</span>, alpha=0.3, density=<span style="color: #268bd2; font-weight: bold;">True</span>, bins=20)
plt.hist(x1, **kwargs)
plt.hist(x2, **kwargs)
plt.hist(x3, **kwargs);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/de7dab01bacfb13bc030e4cf669c2039ffc0d1ff.png" alt="de7dab01bacfb13bc030e4cf669c2039ffc0d1ff.png" />
</p>
</div>

<p>
Two-dimensional histogram with <code>plt.hist2d()</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">mean</span> = [0, 0]
<span style="color: #268bd2;">cov</span> = [[1, 1], [1, 2]]
<span style="color: #268bd2;">x</span>, <span style="color: #268bd2;">y</span> = np.random.multivariate_normal(mean, cov, 10000).transpose()
plt.hist2d(x, y, bins=30, cmap=<span style="color: #2aa198;">'Blues'</span>)
<span style="color: #268bd2;">cb</span> = plt.colorbar()
cb.set_label(<span style="color: #2aa198;">'counts in bin'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/1a9282c345dcbf3483da92714290d9376cd7b69f.png" alt="1a9282c345dcbf3483da92714290d9376cd7b69f.png" />
</p>
</div>

<p>
Hexagonal binnings
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python">plt.hexbin(x, y, gridsize=30, cmap=<span style="color: #2aa198;">'Blues'</span>)
<span style="color: #268bd2;">cb</span> = plt.colorbar(label=<span style="color: #2aa198;">'count in bin'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/633a432e46695c0727c65620b5b05245335e6774.png" alt="633a432e46695c0727c65620b5b05245335e6774.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org2c47a6c" class="outline-3">
<h3 id="org2c47a6c"><span class="section-number-3">4.8</span> Subplots arrangement</h3>
<div class="outline-text-3" id="text-4-8">
<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">grid</span> = plt.GridSpec(2, 3, wspace=0.4, hspace=0.3)
plt.subplot(grid[0, 0])
plt.subplot(grid[0, 1:])
plt.subplot(grid[1, :2])
plt.subplot(grid[1, 2]);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/3629c844d58c922b1220cdb9edb2ad24b27d6d47.png" alt="3629c844d58c922b1220cdb9edb2ad24b27d6d47.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgbf060d8" class="outline-3">
<h3 id="orgbf060d8"><span class="section-number-3">4.9</span> Arrows and annotation</h3>
<div class="outline-text-3" id="text-4-9">
<p>
Use <code>plt.annotate()</code> to add an arrow and some text
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #268bd2;">fig</span>, <span style="color: #268bd2;">ax</span> = plt.subplots()
<span style="color: #268bd2;">x</span> = np.linspace(0, 20, 1000)
ax.plot(x, np.cos(x))
ax.axis(<span style="color: #2aa198;">'equal'</span>)
ax.annotate(<span style="color: #2aa198;">'local maximum'</span>, xy=(6.28, 1), xytext=(10, 4),
            arrowprops=<span style="color: #839496; font-weight: bold;">dict</span>(facecolor=<span style="color: #2aa198;">'black'</span>, shrink=0.05))
<span style="color: #586e75;"># </span><span style="color: #586e75;">angel3 draws a quadratic bezier curve. It casts a ray from starting point in</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">the direction of angleA, and another ray from the end point in the direction</span>
<span style="color: #586e75;"># </span><span style="color: #586e75;">of angleB. The control point is at the intersection of the 2 rays.</span>
ax.annotate(<span style="color: #2aa198;">'local minimum'</span>, xy=(5 * np.pi, -1), xytext=(2, -6),
            arrowprops=<span style="color: #839496; font-weight: bold;">dict</span>(arrowstyle=<span style="color: #2aa198;">"-&gt;"</span>, edgecolor=<span style="color: #2aa198;">'black'</span>,
            connectionstyle=<span style="color: #2aa198;">"angle3,angleA=0,angleB=-60"</span>));
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/31eeb5bab5fe1f86d9db7a00aebd88476bcae13f.png" alt="31eeb5bab5fe1f86d9db7a00aebd88476bcae13f.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org60fb2ab" class="outline-3">
<h3 id="org60fb2ab"><span class="section-number-3">4.10</span> 3D plots</h3>
<div class="outline-text-3" id="text-4-10">
<p>
<code>from mpl_toolkits import mplot3d</code>
</p>

<p>
Once this module is imported, 3d axes can be created by passing
<code>projection='3d'</code>
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #859900; font-weight: bold;">from</span> mpl_toolkits <span style="color: #859900; font-weight: bold;">import</span> mplot3d
<span style="color: #268bd2;">rng</span> = np.random.RandomState(0)
<span style="color: #268bd2;">x</span> = rng.randn(100)
<span style="color: #268bd2;">y</span> = rng.randn(100)
<span style="color: #268bd2;">z</span> = rng.randn(100)
<span style="color: #268bd2;">colors</span> = rng.rand(100)
<span style="color: #268bd2;">ax</span> = plt.axes(projection=<span style="color: #2aa198;">'3d'</span>)
ax.scatter3D(x, y, z, c=colors, cmap=<span style="color: #2aa198;">'viridis'</span>);
</pre>
</div>


<div class="figure">
<p><img src="./.ob-jupyter/298c08f571389eb478851bc5adccde325481f85e.png" alt="298c08f571389eb478851bc5adccde325481f85e.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdc03aed" class="outline-3">
<h3 id="orgdc03aed"><span class="section-number-3">4.11</span> <span class="todo TODO">TODO</span> Geographics data with Basemap</h3>
<div class="outline-text-3" id="text-4-11">
<p>
Basemap is difficult to install. Retry this chapter on a computer with
Anaconda.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2019-07-08 Mon 22:16</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
